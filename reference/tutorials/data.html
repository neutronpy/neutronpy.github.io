

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Data handling with the Data Class &mdash; neutronpy 1.1.0b2 documentation</title>
  

  
  
  
  

  
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Least-squares fitting with the Fitter Class" href="fitting.html" />
    <link rel="prev" title="Basic introduction to using NeutronPy" href="basic.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> neutronpy
          

          
          </a>

          
            
            
              <div class="version">
                1.1.0b2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic.html">Basic introduction to using NeutronPy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Data handling with the Data Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#initialization-loading-data">Initialization: loading data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#load-from-file">Load from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#pass-pre-loaded-data">Pass pre-loaded data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-properties"><code class="docutils literal"><span class="pre">Data</span></code> properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#intensity-and-error">Intensity and error</a></li>
<li class="toctree-l4"><a class="reference internal" href="#monitor-normalization">Monitor normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-normalization">Time normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-q-vector">The <code class="docutils literal"><span class="pre">Q</span></code> vector</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#data-operations"><code class="docutils literal"><span class="pre">Data</span></code> operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quick-analysis">Quick analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#binning-data">Binning data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualizing-data">Visualizing data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basic-plotting">Basic plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#options">Options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html">Least-squares fitting with the Fitter Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui.html">Using the Resolution Calculation Graphical User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="instrument.html">Resolution calculation with Instrument class</a></li>
<li class="toctree-l2"><a class="reference internal" href="material.html">Form Factor calculation with the Material Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Notebook Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">neutronpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Data handling with the Data Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/tutorials/data.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="data-handling-with-the-data-class">
<h1>Data handling with the Data Class<a class="headerlink" href="#data-handling-with-the-data-class" title="Permalink to this headline">¶</a></h1>
<p><em>Note: This module is still a work-in-progress and the usage of these classes and/or functions may change in the future.</em></p>
<p>The following contains examples of how to use the various features in the <a class="reference internal" href="../generated/neutronpy.data.Data.html#neutronpy.data.Data" title="neutronpy.data.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a>, whose purpose is to simplify the handling of neutron scattering data and provide basic analysis and visualization functions.</p>
<div class="section" id="initialization-loading-data">
<h2>Initialization: loading data<a class="headerlink" href="#initialization-loading-data" title="Permalink to this headline">¶</a></h2>
<p>There are a couple of options to initialize the <a class="reference internal" href="../generated/neutronpy.data.Data.html#neutronpy.data.Data" title="neutronpy.data.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> object. If your data is in SPICE (HFIR, ORNL), ICE or ICP (NCNR) formats then you can use <code class="xref py py-meth docutils literal"><span class="pre">load</span></code>, otherwise you will need to load the data and pass it to <a class="reference internal" href="../generated/neutronpy.data.Data.html#neutronpy.data.Data" title="neutronpy.data.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> manually.</p>
<div class="section" id="load-from-file">
<h3>Load from file<a class="headerlink" href="#load-from-file" title="Permalink to this headline">¶</a></h3>
<p>First, let’s assume that you have a data file, <code class="docutils literal"><span class="pre">'scan.dat'</span></code> from a HFIR instrument (SPICE format):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy.fileio</span> <span class="k">import</span> <span class="n">load_data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;scan.dat&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This builds <code class="docutils literal"><span class="pre">data</span></code> automatically and loads all of the data columns from the file.</p>
<p>If you want to load more than one file at a time, simple add the file names as a list or a tuple of file names, <em>e.g.</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">((</span><span class="s1">&#39;scan1.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;scan2.dat&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>By default, <code class="xref py py-meth docutils literal"><span class="pre">load_data</span></code> attempts to determine the format of the input files automatically, but you can specify the <code class="docutils literal"><span class="pre">filetype</span></code> if desired. Valid filetypes are currently:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">'auto'</span></code> - Default: attempt to automatically determine the file type</li>
<li><code class="docutils literal"><span class="pre">'SPICE'</span></code> - HFIR files</li>
<li><code class="docutils literal"><span class="pre">'ICE'</span></code> - NCNR files</li>
<li><code class="docutils literal"><span class="pre">'ICP'</span></code> - NCNR files</li>
<li><code class="docutils literal"><span class="pre">'DCS_MSLICE'</span></code> - ASCII files exported from DCS MSLICE in Dave</li>
<li><code class="docutils literal"><span class="pre">'MAD'</span></code> - ILL files</li>
<li><code class="docutils literal"><span class="pre">'GRASP'</span></code> - ASCII and HDF5 files exported from GRASP</li>
</ul>
</div>
<div class="section" id="pass-pre-loaded-data">
<h3>Pass pre-loaded data<a class="headerlink" href="#pass-pre-loaded-data" title="Permalink to this headline">¶</a></h3>
<p>If your data is not in a format supported by <code class="xref py py-meth docutils literal"><span class="pre">Data.load_data</span></code> you will need to load the data yourself and pass it to the <a class="reference internal" href="../generated/neutronpy.data.Data.html#neutronpy.data.Data" title="neutronpy.data.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> class and build <code class="docutils literal"><span class="pre">Data.Q</span></code> using <code class="xref py py-meth docutils literal"><span class="pre">Data.build_Q</span></code>. To build <code class="docutils literal"><span class="pre">Data.Q</span></code> you must have defined <code class="docutils literal"><span class="pre">h</span></code>, <code class="docutils literal"><span class="pre">k</span></code>, <code class="docutils literal"><span class="pre">l</span></code>, <code class="docutils literal"><span class="pre">e</span></code>, and <code class="docutils literal"><span class="pre">temp</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">,</span> <span class="n">l</span><span class="o">=</span><span class="n">l</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">temp</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span> <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
<span class="go">                monitor=monitor, time=time)</span>
</pre></div>
</div>
<p>However, if you do not need to build <code class="docutils literal"><span class="pre">Data.Q</span></code>, and want to use some subset of the predefined columns (<code class="docutils literal"><span class="pre">h</span></code>, <code class="docutils literal"><span class="pre">k</span></code>, <code class="docutils literal"><span class="pre">l</span></code>, <code class="docutils literal"><span class="pre">e</span></code>, <code class="docutils literal"><span class="pre">temp</span></code>, <code class="docutils literal"><span class="pre">monitor</span></code>, <code class="docutils literal"><span class="pre">detector</span></code>, <code class="docutils literal"><span class="pre">time</span></code>, the undefined columns will be fill by np.zeros, with the length of the data passed.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">(</span><span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In the future, it may be possible to pass arbitrary data to build a bare <code class="docutils literal"><span class="pre">Data</span></code> object with the <code class="docutils literal"><span class="pre">Data.data</span></code> attribute. It is already technically possible to do this by building an empty Data object, and reassigning the .data attribute.</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">angle1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">47</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-properties">
<h2><code class="docutils literal"><span class="pre">Data</span></code> properties<a class="headerlink" href="#data-properties" title="Permalink to this headline">¶</a></h2>
<p>Below I outline some of the most common properties that you will want of the <a class="reference internal" href="../generated/neutronpy.data.Data.html#neutronpy.data.Data" title="neutronpy.data.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> class.</p>
<div class="section" id="intensity-and-error">
<h3>Intensity and error<a class="headerlink" href="#intensity-and-error" title="Permalink to this headline">¶</a></h3>
<p>Intensity, <em>i.e.</em> <code class="docutils literal"><span class="pre">detector</span> <span class="pre">/</span> <span class="pre">monitor</span> <span class="pre">*</span> <span class="pre">m0</span></code> and square-root error are respectively obtained by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">intensity</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">error</span>
</pre></div>
</div>
</div>
<div class="section" id="monitor-normalization">
<h3>Monitor normalization<a class="headerlink" href="#monitor-normalization" title="Permalink to this headline">¶</a></h3>
<p>If you want to normalize to a particular monitor <code class="docutils literal"><span class="pre">m0</span></code> then you will need to define it, <em>e.g.</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">m0</span> <span class="o">=</span> <span class="mf">1e5</span>
</pre></div>
</div>
<p>If you do not choose a <code class="docutils literal"><span class="pre">m0</span></code>, when you call <code class="xref py py-meth docutils literal"><span class="pre">Data.intensity</span></code> one will be defined for you based on the <code class="docutils literal"><span class="pre">monitor</span></code> already defined in <code class="docutils literal"><span class="pre">data</span></code>.</p>
</div>
<div class="section" id="time-normalization">
<h3>Time normalization<a class="headerlink" href="#time-normalization" title="Permalink to this headline">¶</a></h3>
<p>If you want to normalize to a particular time <code class="docutils literal"><span class="pre">t0</span></code> then you will need to set <code class="docutils literal"><span class="pre">time_norm</span></code> to <code class="docutils literal"><span class="pre">True</span></code> and define <code class="docutils literal"><span class="pre">t0</span></code> in minutes, <em>e.g.</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">time_norm</span> <span class="o">=</span> <span class="kc">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
<p>If you do not choose a <code class="docutils literal"><span class="pre">t0</span></code>, when you call <code class="xref py py-meth docutils literal"><span class="pre">Data.intensity</span></code> one will be defined for you based on the <code class="docutils literal"><span class="pre">time</span></code> already defined in <code class="docutils literal"><span class="pre">data</span></code>.</p>
</div>
<div class="section" id="the-q-vector">
<h3>The <code class="docutils literal"><span class="pre">Q</span></code> vector<a class="headerlink" href="#the-q-vector" title="Permalink to this headline">¶</a></h3>
<p>In this case, <code class="docutils literal"><span class="pre">Q</span></code> is collection of column arrays defined as <code class="docutils literal"><span class="pre">[h,</span> <span class="pre">k,</span> <span class="pre">l,</span> <span class="pre">e,</span> <span class="pre">temp]</span></code>, with <code class="docutils literal"><span class="pre">data.Q.shape</span> <span class="pre">=</span> <span class="pre">(N,</span> <span class="pre">5)</span></code>. Typically, one would expect that <code class="docutils literal"><span class="pre">temp</span></code> not be included in <code class="docutils literal"><span class="pre">Q</span></code>, but for the purposes of rebinning it is included currently. <em>In the future, rebinning may be expanded to include other arbitrary dimensions, rather than just these five.</em> If data has been loaded from one of the supported file formats, or <code class="xref py py-meth docutils literal"><span class="pre">Data.build_Q</span></code> has been used then these variables can also be accessed separately by:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">h</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">k</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">l</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">e</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">temp</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="data-operations">
<h2><code class="docutils literal"><span class="pre">Data</span></code> operations<a class="headerlink" href="#data-operations" title="Permalink to this headline">¶</a></h2>
<p>Combining data is as easy as adding multiple <code class="docutils literal"><span class="pre">Data</span></code> objects together, <em>e.g.</em></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;scan1.dat&#39;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;SPICE&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;scan2.dat&#39;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;SPICE&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data1</span> <span class="o">+</span> <span class="n">data2</span>
</pre></div>
</div>
<p>This will combine monitor and detector counts for existing points and concatenate unique points in the two objects to create a new <code class="docutils literal"><span class="pre">data</span></code> object.</p>
<p>Subtracting works in a similar way, but keep in mind that in its current form it doesn’t interpolate, so if <code class="docutils literal"><span class="pre">Q</span></code> is different between the two <code class="docutils literal"><span class="pre">data</span></code> variables then you will end up with negative intensities at positions where there isn’t an overlapping Q. Proper background subtraction will be implemented in the future.</p>
<p>The <code class="docutils literal"><span class="pre">*</span></code>, <code class="docutils literal"><span class="pre">/</span></code> and <code class="docutils literal"><span class="pre">**</span></code> operators only act on the detector variable. This is useful for example if you want to apply the detailed balance factor obtained from <code class="xref py py-meth docutils literal"><span class="pre">Data.detailed_balance_factor</span></code></p>
</div>
<div class="section" id="quick-analysis">
<h2>Quick analysis<a class="headerlink" href="#quick-analysis" title="Permalink to this headline">¶</a></h2>
<p>Often you will want to know the integrated intensity, peak position, and mean-squared width for some part of your data, without relying on fitting. This is easily accomplished with <a class="reference internal" href="../generated/neutronpy.data.Data.integrate.html#neutronpy.data.Data.integrate" title="neutronpy.data.Data.integrate"><code class="xref py py-meth docutils literal"><span class="pre">Data.integrate</span></code></a>, <a class="reference internal" href="../generated/neutronpy.data.Data.position.html#neutronpy.data.Data.position" title="neutronpy.data.Data.position"><code class="xref py py-meth docutils literal"><span class="pre">Data.position</span></code></a>, and <a class="reference internal" href="../generated/neutronpy.data.Data.width.html#neutronpy.data.Data.width" title="neutronpy.data.Data.width"><code class="xref py py-meth docutils literal"><span class="pre">Data.width</span></code></a>.</p>
<p>It is possible to specify the bounds inside which you want to perform these analyses by forming a boolean expression. For example, below is the definition of the bounds of a 1x1 square around (100) at 4 meV:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bounds</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">h</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">k</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&amp;</span>
<span class="go">              (np.abs(data.e - 4) &lt;= 0.25))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">int_inten</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="n">bounds</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="binning-data">
<h2>Binning data<a class="headerlink" href="#binning-data" title="Permalink to this headline">¶</a></h2>
<p>Often data is on an irregular grid with some arbitrary step-size, but you will want to regularly grid your data in some way. You can do this using <a class="reference internal" href="../generated/neutronpy.data.Data.bin.html#neutronpy.data.Data.bin" title="neutronpy.data.Data.bin"><code class="xref py py-meth docutils literal"><span class="pre">Data.bin</span></code></a>. First you need to define the bin parameters as a dictionary of lists in the form <code class="docutils literal"><span class="pre">[start,</span> <span class="pre">end,</span> <span class="pre">bins]</span></code>. Let’s say that we want to bin our data so that we have a <code class="docutils literal"><span class="pre">hk0-e</span></code> volume with 0.025 r.l.u. step size in <code class="docutils literal"><span class="pre">h</span></code> and <code class="docutils literal"><span class="pre">k</span></code> between -2 and 2 r.l.u., and 0.25 meV in <code class="docutils literal"><span class="pre">e</span></code> between -10 and 10 meV, at 300 K for a relatively stable temperature. We would form the bin parameters as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_bin</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">161</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">161</span><span class="p">],</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">              &#39;e&#39;: [-10, 10, 81], &#39;temp&#39;: [290, 310, 1]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binned_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">to_bin</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is a new <a class="reference internal" href="../generated/neutronpy.data.Data.html#neutronpy.data.Data" title="neutronpy.data.Data"><code class="xref py py-class docutils literal"><span class="pre">Data</span></code></a> object, so that your original data is still maintained in the original <em class="xref py py-obj">data</em> object variable.</p>
</div>
<div class="section" id="visualizing-data">
<h2>Visualizing data<a class="headerlink" href="#visualizing-data" title="Permalink to this headline">¶</a></h2>
<p><strong>Note 1</strong>: <a class="reference internal" href="../generated/neutronpy.data.Data.plot.html#neutronpy.data.Data.plot" title="neutronpy.data.Data.plot"><code class="xref py py-meth docutils literal"><span class="pre">Data.plot</span></code></a> is still relatively experimental. 1-D data plotting and fitting works as intended in its current form, but higher dimensional plotting is still very much a work in progress.</p>
<p><strong>Note 2</strong>: For publication quality figures, even for 1-D data, it is not recommended to use <a class="reference internal" href="../generated/neutronpy.data.Data.plot.html#neutronpy.data.Data.plot" title="neutronpy.data.Data.plot"><code class="xref py py-meth docutils literal"><span class="pre">Data.plot</span></code></a>, since some more advanced plot configuration options from matplotlib are not easily available to the user. Instead, <a class="reference internal" href="../generated/neutronpy.data.Data.plot.html#neutronpy.data.Data.plot" title="neutronpy.data.Data.plot"><code class="xref py py-meth docutils literal"><span class="pre">Data.plot</span></code></a> is currently intended to be used for quickly plotting data for easy visualization.</p>
<div class="section" id="basic-plotting">
<h3>Basic plotting<a class="headerlink" href="#basic-plotting" title="Permalink to this headline">¶</a></h3>
<p>Plotting requires at least two parameters to be defined, <code class="docutils literal"><span class="pre">x</span></code> and <code class="docutils literal"><span class="pre">y</span></code> for a line scan plot. By defining <code class="docutils literal"><span class="pre">z</span></code> and <code class="docutils literal"><span class="pre">w</span></code> (or not) you control what type of plot is generated. <code class="docutils literal"><span class="pre">x</span></code>, <code class="docutils literal"><span class="pre">y</span></code>, <code class="docutils literal"><span class="pre">z</span></code>, and <code class="docutils literal"><span class="pre">w</span></code> are defined by assigning one of the following strings: <code class="docutils literal"><span class="pre">'h'</span></code>, <code class="docutils literal"><span class="pre">'k'</span></code>, <code class="docutils literal"><span class="pre">'l'</span></code>, <code class="docutils literal"><span class="pre">'temp'</span></code>, <code class="docutils literal"><span class="pre">'e'</span></code>, or <code class="docutils literal"><span class="pre">'intensity'</span></code>. For example, for a scatter plot with error bars of a line scan, a contour plot of a slice, and a scatter plot of a volume you can do the following, respectively,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;intensity&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="s1">&#39;intensity&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="options">
<h3>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<p>There are several options that can currently be used to enhance the plots, including rebinning, fitting and smoothing. More options will be added in the future to make the plotting more extensible.</p>
<div class="section" id="binning">
<h4>Binning<a class="headerlink" href="#binning" title="Permalink to this headline">¶</a></h4>
<p>Binning can be achieved by passing the <code class="docutils literal"><span class="pre">bin</span></code> dictionary, as defined in the manner described above in the binning section. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">to_bin</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">41</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">              &#39;e&#39;: [3.5, 4.5, 1], &#39;temp&#39;: [290, 310, 1]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="nb">bin</span><span class="o">=</span><span class="n">to_bin</span><span class="p">)</span>
</pre></div>
</div>
<p>If <code class="docutils literal"><span class="pre">bin</span></code> is not defined, then the raw data is plotted, meaning that if you have multidimensional data that you are trying to plot as a line scan, all of the data will be projected onto the line you want to plot.</p>
</div>
<div class="section" id="fitting">
<h4>Fitting<a class="headerlink" href="#fitting" title="Permalink to this headline">¶</a></h4>
<p>Fitting to arbitrary functions, only applicable for line scan plots, can be performed by passing the <code class="docutils literal"><span class="pre">fit_options</span></code> dictionary. At a minimum, the initial parameters <code class="docutils literal"><span class="pre">p</span></code> and the <code class="docutils literal"><span class="pre">function</span></code> must be defined. Additionally, if holding a parameter fixed is desired, <code class="docutils literal"><span class="pre">fixp</span></code> must be defined as a <code class="docutils literal"><span class="pre">list</span></code> of the same length as <code class="docutils literal"><span class="pre">p</span></code> where <code class="docutils literal"><span class="pre">1</span></code> indicates fixed and <code class="docutils literal"><span class="pre">0</span></code> indicates released. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy.functions</span> <span class="k">import</span> <span class="n">gaussian</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="n">fit_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;p&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">],</span>
<span class="go">              &#39;function&#39;: gaussian, &#39;fixp&#39;: [1, 1, 0, 0, 0]})</span>
</pre></div>
</div>
</div>
<div class="section" id="smoothing">
<h4>Smoothing<a class="headerlink" href="#smoothing" title="Permalink to this headline">¶</a></h4>
<p>Smoothing using a multidimensional gaussian filter can be enabled by passing the <code class="docutils literal"><span class="pre">smooth_options</span></code> dictionary with at least a non-zero <code class="docutils literal"><span class="pre">sigma</span></code> value. Other appropriate options can be found in the <a class="reference external" href="http://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.ndimage.filters.gaussian_filter.html">scipy.ndimage.filters.gaussian_filter</a> definition. For example,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;intensity&#39;</span><span class="p">,</span> <span class="n">smooth_options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="plot-options">
<h4>Plot options<a class="headerlink" href="#plot-options" title="Permalink to this headline">¶</a></h4>
<p>Matplotlib plot options may be passed as a dictionary <code class="docutils literal"><span class="pre">plot_options</span></code> to <a class="reference internal" href="../generated/neutronpy.data.Data.plot.html#neutronpy.data.Data.plot" title="neutronpy.data.Data.plot"><code class="xref py py-meth docutils literal"><span class="pre">Data.plot</span></code></a> for the appropriate plot type:</p>
<ul class="simple">
<li>Line scan : <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html?highlight=errorbar#matplotlib.pyplot.errorbar">errorbar</a></li>
<li>Slice : <a class="reference external" href="http://matplotlib.org/api/pyplot_api.html?highlight=pcolormesh#matplotlib.pyplot.pcolormesh">pcolormesh</a></li>
<li>Volume : <a class="reference external" href="http://matplotlib.org/mpl_toolkits/mplot3d/tutorial.html?highlight=scatter#mpl_toolkits.mplot3d.Axes3D.scatter">scatter</a></li>
</ul>
</div>
<div class="section" id="miscellaneous">
<h4>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">show_plot</span></code> : If False, <code class="docutils literal"><span class="pre">plt.show()</span></code> will not be executed inside the <a class="reference internal" href="../generated/neutronpy.data.Data.plot.html#neutronpy.data.Data.plot" title="neutronpy.data.Data.plot"><code class="xref py py-meth docutils literal"><span class="pre">Data.plot</span></code></a> method, and will have to be executed separately. Useful if overplotting.</li>
<li><code class="docutils literal"><span class="pre">output_file</span></code> : If defined, a file with the plot will be saved, in the format specified by the file extension. File type must be supported by the active <a class="reference external" href="http://matplotlib.org/faq/usage_faq.html#what-is-a-backend">matplotlib backend</a></li>
<li><code class="docutils literal"><span class="pre">show_err</span></code> : If False, will not plot error bars on the scan line plot.</li>
</ul>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="fitting.html" class="btn btn-neutral float-right" title="Least-squares fitting with the Fitter Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basic.html" class="btn btn-neutral" title="Basic introduction to using NeutronPy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, David M Fobes.
      Last updated on May 15, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1.0b2',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7542685-4', 'auto');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script>


</body>
</html>