

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Form Factor calculation with the Material Class &mdash; neutronpy 1.0.4 documentation</title>
  

  
  

  
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="neutronpy 1.0.4 documentation" href="../../index.html"/>
        <link rel="up" title="Tutorials" href="../../tutorials.html"/>
        <link rel="next" title="Notebooks" href="../../notebooks.html"/>
        <link rel="prev" title="Resolution calculation with Instrument Class" href="instrument.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> neutronpy
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../index.html">Module Table of Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.html">neutronpy package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.html#members">Members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.html#module-neutronpy">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#indices-and-tables">Indices and tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules.html">neutronpy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.html">neutronpy package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.html#members">Members</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.html#module-neutronpy">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.constants.html">neutronpy.constants module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.magnetic_ion_j.html">neutronpy.constants.magnetic_ion_j</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.periodic_table.html">neutronpy.constants.periodic_table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.scattering_lengths.html">neutronpy.constants.scattering_lengths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.symmetry.html">neutronpy.constants.symmetry</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.JOULES_TO_MEV.html">neutronpy.constants.JOULES_TO_MEV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.BOLTZMANN_IN_MEV_K.html">neutronpy.constants.BOLTZMANN_IN_MEV_K</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.constants.N_A.html">neutronpy.constants.N_A</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.crystal.html">neutronpy.crystal module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Lattice.html">neutronpy.crystal.Lattice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.MagneticFormFactor.html">neutronpy.crystal.MagneticFormFactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.html">neutronpy.crystal.Material</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.NuclearStructureFactor.html">neutronpy.crystal.NuclearStructureFactor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Sample.html">neutronpy.crystal.Sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.SpaceGroup.html">neutronpy.crystal.SpaceGroup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.functions.html">neutronpy.functions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.functions.gaussian.html">neutronpy.functions.gaussian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.functions.gaussian2d.html">neutronpy.functions.gaussian2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.functions.lorentzian.html">neutronpy.functions.lorentzian</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.functions.voigt.html">neutronpy.functions.voigt</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.functions.resolution.html">neutronpy.functions.resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.functions.gaussian_ring.html">neutronpy.functions.gaussian_ring</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.gui.html">neutronpy.gui module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.gui.launch.html">neutronpy.gui.launch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.instrument.html">neutronpy.instrument module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html">neutronpy.instrument.Instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.GetTau.html">neutronpy.instrument.GetTau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Monochromator.html">neutronpy.instrument.Monochromator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Analyzer.html">neutronpy.instrument.Analyzer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.lsfit.html">neutronpy.lsfit module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.lsfit.Fitter.html">neutronpy.lsfit.Fitter</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.fileio.html">neutronpy.fileio module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.fileio.detect_filetype.html">neutronpy.fileio.detect_filetype</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.fileio.load_data.html">neutronpy.fileio.load_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.fileio.load_instrument.html">neutronpy.fileio.load_instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.fileio.save_data.html">neutronpy.fileio.save_data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.models.html">neutronpy.models module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.models.simple_harmonic_oscillator.html">neutronpy.models.simple_harmonic_oscillator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.models.damped_harmonic_oscillator.html">neutronpy.models.damped_harmonic_oscillator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.models.acoustic_phonon_dispersion.html">neutronpy.models.acoustic_phonon_dispersion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.models.ferromagnetic_disperion.html">neutronpy.models.ferromagnetic_disperion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.models.antiferromagnetic_disperion.html">neutronpy.models.antiferromagnetic_disperion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.spurion.html">neutronpy.spurion module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.spurion.aluminum.html">neutronpy.spurion.aluminum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.html">neutronpy package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.html#members">Members</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.data.Data.html">neutronpy.data.data.Data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.energy.Energy.html">neutronpy.energy.Energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.lsfit.Fitter.html">neutronpy.lsfit.Fitter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.instrument.Instrument.html">neutronpy.instrument.instrument.Instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.lattice.Lattice.html">neutronpy.crystal.lattice.Lattice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.material.Material.html">neutronpy.crystal.material.Material</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.sample.Sample.html">neutronpy.crystal.sample.Sample</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.constants.html">neutronpy.constants module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.crystal.html">neutronpy.crystal module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.data.html">neutronpy.data module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.energy.html">neutronpy.energy module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.fileio.html">neutronpy.fileio module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.functions.html">neutronpy.functions module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.gui.html">neutronpy.gui module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.instrument.html">neutronpy.instrument module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.lsfit.html">neutronpy.lsfit module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.models.html">neutronpy.models module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../neutronpy.spurion.html">neutronpy.spurion module</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../neutronpy.html#module-neutronpy">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.constants.html">neutronpy.constants module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.magnetic_ion_j.html">neutronpy.constants.magnetic_ion_j</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.periodic_table.html">neutronpy.constants.periodic_table</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.scattering_lengths.html">neutronpy.constants.scattering_lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.symmetry.html">neutronpy.constants.symmetry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.JOULES_TO_MEV.html">neutronpy.constants.JOULES_TO_MEV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.BOLTZMANN_IN_MEV_K.html">neutronpy.constants.BOLTZMANN_IN_MEV_K</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.constants.N_A.html">neutronpy.constants.N_A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.crystal.html">neutronpy.crystal module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.crystal.Lattice.html">neutronpy.crystal.Lattice</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Lattice.get_d_spacing.html">neutronpy.crystal.Lattice.get_d_spacing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Lattice.get_q.html">neutronpy.crystal.Lattice.get_q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Lattice.get_two_theta.html">neutronpy.crystal.Lattice.get_two_theta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Lattice.get_angle_between_planes.html">neutronpy.crystal.Lattice.get_angle_between_planes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.crystal.MagneticFormFactor.html">neutronpy.crystal.MagneticFormFactor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.MagneticFormFactor.calc_mag_form_fac.html">neutronpy.crystal.MagneticFormFactor.calc_mag_form_fac</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.crystal.Material.html">neutronpy.crystal.Material</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_nuc_str_fac.html">neutronpy.crystal.Material.calc_nuc_str_fac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_mag_str_fac.html">neutronpy.crystal.Material.calc_mag_str_fac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_mag_int_vec.html">neutronpy.crystal.Material.calc_mag_int_vec</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_incoh_elas_xs.html">neutronpy.crystal.Material.calc_incoh_elas_xs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_optimal_thickness.html">neutronpy.crystal.Material.calc_optimal_thickness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.plot_unit_cell.html">neutronpy.crystal.Material.plot_unit_cell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.get_angle_between_planes.html">neutronpy.crystal.Material.get_angle_between_planes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.get_d_spacing.html">neutronpy.crystal.Material.get_d_spacing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.get_q.html">neutronpy.crystal.Material.get_q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.get_two_theta.html">neutronpy.crystal.Material.get_two_theta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Material.N_atoms.html">neutronpy.crystal.Material.N_atoms</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.crystal.NuclearStructureFactor.html">neutronpy.crystal.NuclearStructureFactor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.NuclearStructureFactor.calc_nuc_str_fac.html">neutronpy.crystal.NuclearStructureFactor.calc_nuc_str_fac</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.crystal.Sample.html">neutronpy.crystal.Sample</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Sample.get_d_spacing.html">neutronpy.crystal.Sample.get_d_spacing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Sample.get_q.html">neutronpy.crystal.Sample.get_q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Sample.get_two_theta.html">neutronpy.crystal.Sample.get_two_theta</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.Sample.get_angle_between_planes.html">neutronpy.crystal.Sample.get_angle_between_planes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.crystal.SpaceGroup.html">neutronpy.crystal.SpaceGroup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.crystal.SpaceGroup.symmetrize_position.html">neutronpy.crystal.SpaceGroup.symmetrize_position</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.data.html">neutronpy.data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.data.Data.html">neutronpy.data.Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.bin.html">neutronpy.data.Data.bin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.combine_data.html">neutronpy.data.Data.combine_data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.subtract_background.html">neutronpy.data.Data.subtract_background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.integrate.html">neutronpy.data.Data.integrate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.position.html">neutronpy.data.Data.position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.width.html">neutronpy.data.Data.width</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.estimate_background.html">neutronpy.data.Data.estimate_background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.subtract_background.html">neutronpy.data.Data.subtract_background</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.dynamic_susceptibility.html">neutronpy.data.Data.dynamic_susceptibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.scattering_function.html">neutronpy.data.Data.scattering_function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Data.plot.html">neutronpy.data.Data.plot</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.data.Analysis.html">neutronpy.data.Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Analysis.integrate.html">neutronpy.data.Analysis.integrate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Analysis.position.html">neutronpy.data.Analysis.position</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Analysis.width.html">neutronpy.data.Analysis.width</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Analysis.scattering_function.html">neutronpy.data.Analysis.scattering_function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Analysis.dynamic_susceptibility.html">neutronpy.data.Analysis.dynamic_susceptibility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Analysis.estimate_background.html">neutronpy.data.Analysis.estimate_background</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.data.Scans.html">neutronpy.data.Scans</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Scans.waterfall.html">neutronpy.data.Scans.waterfall</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Scans.pcolor.html">neutronpy.data.Scans.pcolor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Scans.func_col.html">neutronpy.data.Scans.func_col</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Scans.min_col.html">neutronpy.data.Scans.min_col</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.data.Scans.max_col.html">neutronpy.data.Scans.max_col</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.energy.html">neutronpy.energy module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.energy.Energy.html">neutronpy.energy.Energy</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.fileio.html">neutronpy.fileio module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.fileio.detect_filetype.html">neutronpy.fileio.detect_filetype</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.fileio.load_data.html">neutronpy.fileio.load_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.fileio.load_instrument.html">neutronpy.fileio.load_instrument</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.fileio.save_data.html">neutronpy.fileio.save_data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.functions.html">neutronpy.functions module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.functions.gaussian.html">neutronpy.functions.gaussian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.functions.gaussian2d.html">neutronpy.functions.gaussian2d</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.functions.lorentzian.html">neutronpy.functions.lorentzian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.functions.voigt.html">neutronpy.functions.voigt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.functions.resolution.html">neutronpy.functions.resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.functions.gaussian_ring.html">neutronpy.functions.gaussian_ring</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.gui.html">neutronpy.gui module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.gui.launch.html">neutronpy.gui.launch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.instrument.html">neutronpy.instrument module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html">neutronpy.instrument.Instrument</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.calc_resolution.html">neutronpy.instrument.Instrument.calc_resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.calc_resolution_in_Q_coords.html">neutronpy.instrument.Instrument.calc_resolution_in_Q_coords</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.calc_projections.html">neutronpy.instrument.Instrument.calc_projections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.get_angles_and_Q.html">neutronpy.instrument.Instrument.get_angles_and_Q</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.get_lattice.html">neutronpy.instrument.Instrument.get_lattice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.get_resolution_params.html">neutronpy.instrument.Instrument.get_resolution_params</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.plot_projections.html">neutronpy.instrument.Instrument.plot_projections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.plot_ellipsoid.html">neutronpy.instrument.Instrument.plot_ellipsoid</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.plot_instrument.html">neutronpy.instrument.Instrument.plot_instrument</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.resolution_convolution.html">neutronpy.instrument.Instrument.resolution_convolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.resolution_convolution_SMA.html">neutronpy.instrument.Instrument.resolution_convolution_SMA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.plot_slice.html">neutronpy.instrument.Instrument.plot_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.instrument.Instrument.description_string.html">neutronpy.instrument.Instrument.description_string</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.instrument.GetTau.html">neutronpy.instrument.GetTau</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.instrument.Monochromator.html">neutronpy.instrument.Monochromator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.instrument.Analyzer.html">neutronpy.instrument.Analyzer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.lsfit.html">neutronpy.lsfit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.lsfit.Fitter.html">neutronpy.lsfit.Fitter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../generated/neutronpy.lsfit.Fitter.fit.html">neutronpy.lsfit.Fitter.fit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.models.html">neutronpy.models module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.models.simple_harmonic_oscillator.html">neutronpy.models.simple_harmonic_oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.models.damped_harmonic_oscillator.html">neutronpy.models.damped_harmonic_oscillator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.models.acoustic_phonon_dispersion.html">neutronpy.models.acoustic_phonon_dispersion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.models.ferromagnetic_disperion.html">neutronpy.models.ferromagnetic_disperion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.models.antiferromagnetic_disperion.html">neutronpy.models.antiferromagnetic_disperion</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../neutronpy.spurion.html">neutronpy.spurion module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../generated/neutronpy.spurion.aluminum.html">neutronpy.spurion.aluminum</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic.html">Basic introduction to using NeutronPy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="basic.html#importing-and-using-neutronpy">Importing and using NeutronPy</a></li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#handling-data">Handling Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#converting-neutron-energy">Converting Neutron Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#fitting-data">Fitting Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#calculating-triple-axis-resolution">Calculating Triple-Axis Resolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="basic.html#using-the-triple-axis-resolution-gui">Using the Triple-Axis Resolution GUI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#performing-lattice-geometry-calculations">Performing Lattice Geometry Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#performing-structure-factor-calculations">Performing Structure Factor Calculations</a></li>
<li class="toctree-l3"><a class="reference internal" href="basic.html#finding-aluminum-spurion-positions">Finding Aluminum Spurion Positions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data handling with the Data Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#initialization-loading-data">Initialization: loading data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data.html#load-from-file">Load from file</a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#pass-pre-loaded-data">Pass pre-loaded data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html#data-properties"><code class="docutils literal"><span class="pre">Data</span></code> properties</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data.html#intensity-and-error">Intensity and error</a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#monitor-normalization">Monitor normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#time-normalization">Time normalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#the-q-vector">The <code class="docutils literal"><span class="pre">Q</span></code> vector</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="data.html#data-operations"><code class="docutils literal"><span class="pre">Data</span></code> operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#quick-analysis">Quick analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#binning-data">Binning data</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#visualizing-data">Visualizing data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="data.html#basic-plotting">Basic plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html#options">Options</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html">Least-squares fitting with the Fitter Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="fitting.html#defining-the-problem">Defining the problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="fitting.html#initializing">Initializing</a></li>
<li class="toctree-l3"><a class="reference internal" href="fitting.html#initial-parameters-and-constraints">Initial parameters and Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="fitting.html#fitting">Fitting</a></li>
<li class="toctree-l3"><a class="reference internal" href="fitting.html#results">Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="gui.html">Using the Resolution Calculation Graphical User Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="instrument.html">Resolution calculation with Instrument Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#instrument-configuration">Instrument Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#sample-configuration">Sample Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#initializing-the-instrument">Initializing the Instrument</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#calculating-the-resolution">Calculating the resolution</a><ul>
<li class="toctree-l4"><a class="reference internal" href="instrument.html#resolution-parameters">Resolution parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="instrument.html#resolution-ellipses">Resolution ellipses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#popovici-calculation">Popovici calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#simple-plotting-of-resolution-ellipses">Simple Plotting of Resolution Ellipses</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#simple-plotting-of-the-3d-resolution-ellipsoid">Simple Plotting of the 3D Resolution Ellipsoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#plotting-of-the-instrument-setup-for-a-given-q-w">Plotting of the Instrument setup for a given (Q,W)</a></li>
<li class="toctree-l3"><a class="reference internal" href="instrument.html#loading-an-instrument-and-sample-from-files">Loading an Instrument and Sample from files</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Form Factor calculation with the Material Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#defining-the-material">Defining the Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initializing-the-material-class">Initializing the Material class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-the-structure-factor">Calculating the structure factor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-space-group-to-properly-symmetrize">Using space group to properly symmetrize</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Notebook Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/neutronpy_resolution_convolution_4D_example.html">Resolution Convolution (4D) Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/neutronpy_resolution_convolution_SMA_example.html">Resolution Convolution (SMA) Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#anaconda-cloud-conda-recommended">Anaconda Cloud - conda – <strong>Recommended</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#python-package-index-pip">Python Package Index - pip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installation-from-source">Installation from Source</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development.html#requirements">Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#write-for-python-3">Write for Python 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#pep8-formatting">PEP8 Formatting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#documentation">Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#unit-tests">Unit tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../development.html#development-workflow">Development Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#fork-and-clone">Fork and clone</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#create-a-branch">Create a branch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#commit-changes">Commit changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#rebase-on-neutronpy-master">Rebase on neutronpy <code class="docutils literal"><span class="pre">master</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#create-pull-request">Create pull request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../development.html#cleanup">Cleanup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../development.html#development-environment">Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development.html#versions">Versions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../roadmap.html#milestones">Milestones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../roadmap.html#next-release">Next Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../roadmap.html#future-features">Future Features</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contact.html#bugs-ticket-tracker">Bugs/ticket tracker</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">neutronpy</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
        <li><a href="../../tutorials.html">Tutorials</a> &raquo;</li>
      
    <li>Form Factor calculation with the Material Class</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="../../_sources/reference/tutorials/material.rst.txt" rel="nofollow"> View page source</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="form-factor-calculation-with-the-material-class">
<h1>Form Factor calculation with the Material Class<a class="headerlink" href="#form-factor-calculation-with-the-material-class" title="Permalink to this headline">¶</a></h1>
<p><em>Note: This module is still a work-in-progress and the usage of these classes and/or functions may change in the future.</em></p>
<p>The following are examples on the usage of the <a class="reference internal" href="../generated/neutronpy.crystal.Material.html#neutronpy.crystal.Material" title="neutronpy.crystal.Material"><code class="xref py py-class docutils literal"><span class="pre">Material</span></code></a> class, used to define a material and calculate the structural form factor in reciprocal lattice units for a given <span class="math">\(q\)</span>. This tutorial will cover the utilization of this class and its methods.</p>
<div class="section" id="defining-the-material">
<h2>Defining the Material<a class="headerlink" href="#defining-the-material" title="Permalink to this headline">¶</a></h2>
<p>For this example we will use Fe<sub>1.1</sub>Te, a high-temperature tetragonal <span class="math">\(P4/nmm\)</span> structure with Fe in the 2a positions, Te in the 2c positions, and excess Fe in the interstitial 2c positions. First we build the dictionary defining the material to pass it to the class:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">def_FeTe</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Fe1.1Te&#39;</span><span class="p">,</span>
            <span class="s1">&#39;composition&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]},</span>
                            <span class="p">{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]},</span>
                            <span class="p">{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span> <span class="s1">&#39;Te&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.2839</span><span class="p">]},</span>
                            <span class="p">{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span> <span class="s1">&#39;Te&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2839</span><span class="p">]},</span>
                            <span class="p">{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.721</span><span class="p">],</span> <span class="s1">&#39;occupancy&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">},</span>
                            <span class="p">{</span><span class="s1">&#39;ion&#39;</span><span class="p">:</span> <span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.721</span><span class="p">],</span> <span class="s1">&#39;occupancy&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">}],</span>
            <span class="s1">&#39;debye-waller&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;massNorm&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>
            <span class="s1">&#39;lattice&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;abc&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">3.81</span><span class="p">,</span> <span class="mf">3.81</span><span class="p">,</span> <span class="mf">6.25</span><span class="p">],</span>
                        <span class="s1">&#39;abg&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]},</span>
           <span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">'massNorm'</span></code> key should be set to <code class="docutils literal"><span class="pre">False</span></code> to return the structure factor in units of <code class="docutils literal"><span class="pre">barns</span></code>. <code class="docutils literal"><span class="pre">'massNorm'</span></code> is used for calculation of the coherent one-phonon inelastic cross-section, which depends on a calculation of nuclear structure factor in which the coherent scattering lengths are normalized by the square-root of the atomic mass <em>i.e.</em> <span class="math">\(\bar{b}_d/\sqrt{M_d}\)</span> (see Eq. 4.88 in “Theory of neutron scattering from condensed matter, Volume 1” by Stephen W. Lovesey.</p>
</div>
</div>
<div class="section" id="initializing-the-material-class">
<h2>Initializing the Material class<a class="headerlink" href="#initializing-the-material-class" title="Permalink to this headline">¶</a></h2>
<p>Once we have built our material in the above format we can initialize the class.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy</span> <span class="k">import</span> <span class="n">Material</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FeTe</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">def_FeTe</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="calculating-the-structure-factor">
<h2>Calculating the structure factor<a class="headerlink" href="#calculating-the-structure-factor" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The structure factor calculation method <a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_nuc_str_fac.html#neutronpy.crystal.Material.calc_nuc_str_fac" title="neutronpy.crystal.Material.calc_nuc_str_fac"><code class="xref py py-meth docutils literal"><span class="pre">calc_nuc_str_fac</span></code></a> returns the full structure factor term <span class="math">\(F(q)\)</span>, including any imaginary parts, and not <span class="math">\(\left|F(q)\right|^2\)</span> which is typically used in other calculations.</p>
</div>
<p>Now that our material is defined, we can calculate the structural form factor with <a class="reference internal" href="../generated/neutronpy.crystal.Material.calc_nuc_str_fac.html#neutronpy.crystal.Material.calc_nuc_str_fac" title="neutronpy.crystal.Material.calc_nuc_str_fac"><code class="xref py py-meth docutils literal"><span class="pre">calc_nuc_str_fac</span></code></a>. First, we will calculate it at a single point <span class="math">\(q\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">str_fac</span> <span class="o">=</span> <span class="n">FeTe</span><span class="o">.</span><span class="n">calc_nuc_str_fac</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also calculate the structure factor over a range of values in a similar way. In this example we are calculating the structure factor in the (h, k, 0) plane where <span class="math">\(0 &lt; h,k &lt; 2\)</span>, with a step size of 0.025 r.l.u.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">41</span><span class="p">),</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">str_fac</span> <span class="o">=</span> <span class="n">FeTe</span><span class="o">.</span><span class="n">calc_nuc_str_fac</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>The resulting plot of this structure factor would look like the following figure.</p>
<p>(<a class="reference external" href="../../reference/tutorials/material-1.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/material-1.png">png</a>, <a class="reference external" href="../../reference/tutorials/material-1.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/material-1.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/material-1.png" src="../../_images/material-1.png" />
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above picture will only be reproducible if the structure factor is partially symmetrized, <em>i.e.</em> in this case the calculation would be:</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">str_fac</span> <span class="o">=</span> <span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FeTe</span><span class="o">.</span><span class="n">calc_nuc_str_fac</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FeTe</span><span class="o">.</span><span class="n">calc_nuc_str_fac</span><span class="p">((</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FeTe</span><span class="o">.</span><span class="n">calc_nuc_str_fac</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">FeTe</span><span class="o">.</span><span class="n">calc_nuc_str_fac</span><span class="p">((</span><span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">-</span><span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-space-group-to-properly-symmetrize">
<h2>Using space group to properly symmetrize<a class="headerlink" href="#using-space-group-to-properly-symmetrize" title="Permalink to this headline">¶</a></h2>
<p>By providing a space group symbol or number in the following way it is possible to automatically symmetrize a crystal structure.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">def_FeTe</span><span class="p">[</span><span class="s1">&#39;space_group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;P4/nmm&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">FeTe</span> <span class="o">=</span> <span class="n">Material</span><span class="p">(</span><span class="n">def_FeTe</span><span class="p">)</span>
</pre></div>
</div>
<p>Calculating the resulting Material object’s structure factor as in the previous example would result in the following figure, where the crystal structure is fully symmetrized.</p>
<p>(<a class="reference external" href="../../reference/tutorials/material-2.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/material-2.png">png</a>, <a class="reference external" href="../../reference/tutorials/material-2.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/material-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/material-2.png" src="../../_images/material-2.png" />
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This feature is currently broken in the sense the absolute values are incorrect due to a bug in the symmetrization routine.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../notebooks.html" class="btn btn-neutral float-right" title="Notebooks" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="instrument.html" class="btn btn-neutral" title="Resolution calculation with Instrument Class" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, David M Fobes.
      Last updated on May 09, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7542685-4', 'auto');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script>


</body>
</html>