

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Resolution calculation with Instrument class &mdash; neutronpy 1.1.1 documentation</title>
  

  
  
  
  

  
    <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Form Factor calculation with the Material Class" href="material.html" />
    <link rel="prev" title="Using the Resolution Calculation Graphical User Interface" href="gui.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> neutronpy
          

          
          </a>

          
            
            
              <div class="version">
                1.1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../reference.html">Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basic.html">Basic introduction to using NeutronPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data handling with the Data Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html">Least-squares fitting with the Fitter Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="gui.html">Using the Resolution Calculation Graphical User Interface</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Resolution calculation with Instrument class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#triple-axis-instruments">Triple Axis Instruments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#instrument-configuration">Instrument Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#calculating-the-resolution">Calculating the resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting">Plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#file-io">File IO</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#time-of-flight-spectrometers">Time of Flight spectrometers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">Instrument Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resolution-calculation">Resolution calculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">File IO</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="material.html">Form Factor calculation with the Material Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Notebook Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">neutronpy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Resolution calculation with Instrument class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/tutorials/instrument.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="resolution-calculation-with-instrument-class">
<h1>Resolution calculation with Instrument class<a class="headerlink" href="#resolution-calculation-with-instrument-class" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial usage examples of :py:class`.Instrument` for both Triple Axis and Time of Flight instruments will be given. While the Triple Axis instrument features are stable, Time of Flight instrumentation is still under development, and there could be minor changes and major additions going forward.</p>
<div class="section" id="triple-axis-instruments">
<h2>Triple Axis Instruments<a class="headerlink" href="#triple-axis-instruments" title="Permalink to this headline">¶</a></h2>
<p>The following are examples on the usage of the <a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html#neutronpy.instrument.Instrument" title="neutronpy.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> class with <code class="docutils literal notranslate"><span class="pre">instrument_type=&quot;tas&quot;</span></code>, which instances a <a class="reference internal" href="../generated/neutronpy.instrument.TripleAxisInstrument.html#neutronpy.instrument.TripleAxisInstrument" title="neutronpy.instrument.TripleAxisInstrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleAxisInstrument</span></code></a> object, used to define a triple-axis spectrometer instrument configuration and calculate the resolution in reciprocal lattice units for a given sample at a given wave-vector <span class="math notranslate nohighlight">\(q\)</span>. The next sections of this tutorial will cover the utilization of both Cooper-Nathans and Popovici calculation methods. The tutorial for Time of Flight spectrometers follows these sections.</p>
<div class="section" id="instrument-configuration">
<h3>Instrument Configuration<a class="headerlink" href="#instrument-configuration" title="Permalink to this headline">¶</a></h3>
<p>First, we will begin by defining an generic triple-axis spectrometer instrument configuration that we will use for this example.</p>
<p>(<a class="reference external" href="../../reference/tutorials/instrument-1.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/instrument-1.png">png</a>, <a class="reference external" href="../../reference/tutorials/instrument-1.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/instrument-1.pdf">pdf</a>)</p>
<div class="figure">
<a class="reference internal image-reference" href="../../_images/instrument-1.png"><img alt="../../_images/instrument-1.png" src="../../_images/instrument-1.png" style="width: 800px; height: 200px;" /></a>
</div>
<p>For the Cooper-Nathans calculation only a rudimentary set of information is required to estimate the resolution at a given <span class="math notranslate nohighlight">\(q\)</span>. Namely, the fixed energy (incident or final), the relevant (horizontal) collimations (Col<span class="math notranslate nohighlight">\(_n\)</span>), and the monochromator and analyzer crystal types (or <span class="math notranslate nohighlight">\(\tau\)</span>, if the crystal type is not included in this software). In this case we will use the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">efixed</span> <span class="o">=</span> <span class="mf">14.7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hcol</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ana</span> <span class="o">=</span> <span class="s1">&#39;PG(002)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mono</span> <span class="o">=</span> <span class="s1">&#39;PG(002)&#39;</span>
</pre></div>
</div>
<p>The rest of the <em>required</em> information are all dependent on the sample configuration.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Many settings have default values, that don’t need to be changed for the resolution calculation to function, but will provide more accuracy if assigned appropriate values.**</p>
</div>
<div class="section" id="sample-configuration">
<h4>Sample Configuration<a class="headerlink" href="#sample-configuration" title="Permalink to this headline">¶</a></h4>
<p>Defining the sample using the <a class="reference internal" href="../generated/neutronpy.crystal.Sample.html#neutronpy.crystal.Sample" title="neutronpy.crystal.Sample"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sample</span></code></a> class is simple. In this example we define an arbitrary sample with no given sample mosaic.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy</span> <span class="k">import</span> <span class="n">Sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>where the inputs for <code class="docutils literal notranslate"><span class="pre">Sample</span></code> are <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, <code class="docutils literal notranslate"><span class="pre">beta</span></code>, <code class="docutils literal notranslate"><span class="pre">gamma</span></code>, and <code class="docutils literal notranslate"><span class="pre">mosaic</span></code>, respectively, and <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> are the orientation vectors in reciprocal lattice units. In this case the sample is oriented in the (<em>h</em>, <em>k</em>, 0)-plane</p>
</div>
<div class="section" id="initializing-the-instrument">
<h4>Initializing the Instrument<a class="headerlink" href="#initializing-the-instrument" title="Permalink to this headline">¶</a></h4>
<p>Once the sample is defined and information about the instrument collected we can formally define the instrument using <a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html#neutronpy.instrument.Instrument" title="neutronpy.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> and the variables that we have already assigned above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy</span> <span class="k">import</span> <span class="n">Instrument</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">(</span><span class="n">efixed</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">hcol</span><span class="p">,</span> <span class="n">ana</span><span class="o">=</span><span class="n">ana</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="n">mono</span><span class="p">)</span>
</pre></div>
</div>
<p>There are a great deal more settings available than are used here; see <a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html#neutronpy.instrument.Instrument" title="neutronpy.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> documentation.</p>
</div>
</div>
<div class="section" id="calculating-the-resolution">
<h3>Calculating the resolution<a class="headerlink" href="#calculating-the-resolution" title="Permalink to this headline">¶</a></h3>
<p>To calculate the resolution we need to define at which <span class="math notranslate nohighlight">\(q=[h,k,l,\hbar\omega]\)</span> we want the resolution to be calculated. There are several ways that we can go about doing this. The simplest situation is if the resolution is desired at only one point in reciprocal space, <em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0,</span> <span class="pre">0,</span> <span class="pre">0]</span></code>, <em>i.e.</em> (1, 0, 0) at zero energy transfer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>More positions can be easily added; <em>e.g.</em> if we wanted to add (0.5, 0.5, 0) at 0 meV, and (0.5, 0., 0.5) at 8~meV, our <code class="docutils literal notranslate"><span class="pre">q</span></code> would have the structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<p>We will use this second <code class="docutils literal notranslate"><span class="pre">q</span></code> to calculate the resolution.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We use <code class="docutils literal notranslate"><span class="pre">np.array()</span></code> here to allow us to use ‘fancy indexing’, which will simplify using slices of <code class="docutils literal notranslate"><span class="pre">q</span></code> later.</p>
</div>
<div class="section" id="resolution-parameters">
<h4>Resolution parameters<a class="headerlink" href="#resolution-parameters" title="Permalink to this headline">¶</a></h4>
<p>To calculate the resolution parameters, without needing projections or plots, one may use <a class="reference internal" href="../generated/neutronpy.instrument.TimeOfFlightInstrument.calc_resolution.html#neutronpy.instrument.TimeOfFlightInstrument.calc_resolution" title="neutronpy.instrument.TimeOfFlightInstrument.calc_resolution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_resolution</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">calc_resolution</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting resolution parameters, <span class="math notranslate nohighlight">\(R_0\)</span> and <span class="math notranslate nohighlight">\(\mathbf{R}_M\)</span>, are saved in the <code class="docutils literal notranslate"><span class="pre">EXP</span></code> variable and can be accessed by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">RMS</span> <span class="o">=</span> <span class="n">EXP</span><span class="o">.</span><span class="n">RMS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R0</span> <span class="o">=</span> <span class="n">EXP</span><span class="o">.</span><span class="n">R0</span>
</pre></div>
</div>
<p>The resolution matrix here is the full matrix, over four dimensional space N (4 <span class="math notranslate nohighlight">\(\times\)</span> 4) matrices, with shape (4, 4, N) (N=3 in our case). Alternatively, it is possible to extract more immediately useful parameters, i.e. projections or slices in the plane of interest using <a class="reference internal" href="../generated/neutronpy.instrument.GeneralInstrument.get_resolution_params.html#neutronpy.instrument.GeneralInstrument.get_resolution_params" title="neutronpy.instrument.GeneralInstrument.get_resolution_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_resolution_params</span></code></a>.</p>
<p>We can get projections or slices in the <em>x-y</em>, <em>x-e</em> or <em>y-e</em> planes (see <a class="reference internal" href="../generated/neutronpy.instrument.GeneralInstrument.get_resolution_params.html#neutronpy.instrument.GeneralInstrument.get_resolution_params" title="neutronpy.instrument.GeneralInstrument.get_resolution_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_resolution_params</span></code></a> documentation for all possible keywords); the z-plane is not accessible due to the nature of the sample orientation and is integrated out. In this case we will extract the resolution parameters for the projection into the <span class="math notranslate nohighlight">\(Q_x Q_y\)</span> plane for the first <code class="docutils literal notranslate"><span class="pre">q</span></code>, <em>i.e.</em> <code class="docutils literal notranslate"><span class="pre">[1,0,0,0]</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R0</span><span class="p">,</span> <span class="n">RMxx</span><span class="p">,</span> <span class="n">RMyy</span><span class="p">,</span> <span class="n">RMxy</span> <span class="o">=</span> <span class="n">EXP</span><span class="o">.</span><span class="n">get_resolution_params</span><span class="p">(</span><span class="n">q</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;QxQy&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;project&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">RMxx</span></code> and <code class="docutils literal notranslate"><span class="pre">RMyy</span></code> are the diagonals of the resolution matrix, <code class="docutils literal notranslate"><span class="pre">RMxy</span></code> is the off-diagonals, and <code class="docutils literal notranslate"><span class="pre">R0</span></code> is the pre-factor. An error will be thrown if a <code class="docutils literal notranslate"><span class="pre">q</span></code> that was not previously calculated is given.</p>
</div>
<div class="section" id="resolution-ellipses">
<h4>Resolution ellipses<a class="headerlink" href="#resolution-ellipses" title="Permalink to this headline">¶</a></h4>
<p>The resolution ellipses are calculated when <a class="reference internal" href="../generated/neutronpy.instrument.GeneralInstrument.calc_projections.html#neutronpy.instrument.GeneralInstrument.calc_projections" title="neutronpy.instrument.GeneralInstrument.calc_projections"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_projections</span></code></a> is called, and can be accessed using <a class="reference internal" href="../generated/neutronpy.instrument.GeneralInstrument.calc_projections.html#neutronpy.instrument.GeneralInstrument.calc_projections" title="neutronpy.instrument.GeneralInstrument.calc_projections"><code class="xref py py-meth docutils literal notranslate"><span class="pre">calc_projections</span></code></a>, which is a dictionary with the keys <code class="docutils literal notranslate"><span class="pre">QxQy</span></code>, <code class="docutils literal notranslate"><span class="pre">QxQySlice</span></code>, <code class="docutils literal notranslate"><span class="pre">QxW</span></code>, <code class="docutils literal notranslate"><span class="pre">QxWSlice</span></code>, <code class="docutils literal notranslate"><span class="pre">QyW</span></code>, and <code class="docutils literal notranslate"><span class="pre">QyWSlice</span></code>, providing <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> values.</p>
<p>The following is an example of a resolution calculation using the Cooper-Nathans method (for a projection in the <span class="math notranslate nohighlight">\(Q_x Q_y\)</span> plane), with resolution ellipses (projection (filled) and slice (dashed)) overlaid, using the settings we have used in this example.</p>
<p>(<a class="reference external" href="../../reference/tutorials/instrument-2.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/instrument-2.png">png</a>, <a class="reference external" href="../../reference/tutorials/instrument-2.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/instrument-2.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/instrument-2.png" src="../../_images/instrument-2.png" />
</div>
</div>
<div class="section" id="popovici-calculation">
<h4>Popovici calculation<a class="headerlink" href="#popovici-calculation" title="Permalink to this headline">¶</a></h4>
<p>All of the previous sections are still relevant and are necessary for the Popovici method of resolution calculation, but more details about the instrument are required, and the Popovici method must be enabled. The most essential properties that need to be defined are the distances between each major element of the instrument, namely, guide-to-monochromator, monochromator-to-sample, sample-to-analyzer, and analyzer-to-detector. These distances are assigned to the <code class="xref py py-attr docutils literal notranslate"><span class="pre">arms</span></code> property in the above order:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">arms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1560</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">260</span><span class="p">,</span> <span class="mi">300</span><span class="p">]</span>
</pre></div>
</div>
<p>Once this variable is set we can enable the Popovici method and recalculate the resolutions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">method</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">calc_resolution</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Like with the Cooper-Nathans method above, many of these settings have default values, that don’t need to be changed for the resolution calculation to function, but will provide more accuracy if assigned appropriate values.</p>
</div>
<p>The following is an example of a resolution calculation using the Popovici method (for a projection in the <span class="math notranslate nohighlight">\(Q_x Q_y\)</span> plane), with resolution ellipses (projection (filled) and slice (dashed)) overlaid, using the settings used in this example.</p>
<p>(<a class="reference external" href="../../reference/tutorials/instrument-3.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/instrument-3.png">png</a>, <a class="reference external" href="../../reference/tutorials/instrument-3.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/instrument-3.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/instrument-3.png" src="../../_images/instrument-3.png" />
</div>
</div>
</div>
<div class="section" id="plotting">
<h3>Plotting<a class="headerlink" href="#plotting" title="Permalink to this headline">¶</a></h3>
<div class="section" id="simple-plotting-of-resolution-ellipses">
<h4>Simple Plotting of Resolution Ellipses<a class="headerlink" href="#simple-plotting-of-resolution-ellipses" title="Permalink to this headline">¶</a></h4>
<p>To see a simple plot of the resolution ellipses in the <span class="math notranslate nohighlight">\(Q_x Q_y\)</span>, <span class="math notranslate nohighlight">\(Q_x W\)</span> and <span class="math notranslate nohighlight">\(Q_y W\)</span> zones the <a class="reference internal" href="../generated/neutronpy.instrument.PlotInstrument.plot_projections.html#neutronpy.instrument.PlotInstrument.plot_projections" title="neutronpy.instrument.PlotInstrument.plot_projections"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_projections</span></code></a> method may be used. This will also display instrument setup parameters and other useful information such as Bragg widths.</p>
<p>A very simple plot for the default instrument, containing resolution ellipses for several different energies at may be obtained with these commands</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">linspace</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">plot_projections</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">)])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../reference/tutorials/instrument-4.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/instrument-4.png">png</a>, <a class="reference external" href="../../reference/tutorials/instrument-4.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/instrument-4.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/instrument-4.png" src="../../_images/instrument-4.png" />
</div>
</div>
<div class="section" id="simple-plotting-of-the-3d-resolution-ellipsoid">
<h4>Simple Plotting of the 3D Resolution Ellipsoid<a class="headerlink" href="#simple-plotting-of-the-3d-resolution-ellipsoid" title="Permalink to this headline">¶</a></h4>
<p>To see a simple plot of the resolution ellipsoid in the <span class="math notranslate nohighlight">\(Q_x Q_y W\)</span> zone the <a class="reference internal" href="../generated/neutronpy.instrument.PlotInstrument.plot_ellipsoid.html#neutronpy.instrument.PlotInstrument.plot_ellipsoid" title="neutronpy.instrument.PlotInstrument.plot_ellipsoid"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_ellipsoid</span></code></a> method can be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">plot_ellipsoid</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../reference/tutorials/instrument-5.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/instrument-5.png">png</a>, <a class="reference external" href="../../reference/tutorials/instrument-5.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/instrument-5.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/instrument-5.png" src="../../_images/instrument-5.png" />
</div>
</div>
<div class="section" id="plotting-of-the-instrument-setup-for-a-given-q-w">
<h4>Plotting of the Instrument setup for a given (Q,W)<a class="headerlink" href="#plotting-of-the-instrument-setup-for-a-given-q-w" title="Permalink to this headline">¶</a></h4>
<p>To see a plot of the instrument setup using the angles required for a given <span class="math notranslate nohighlight">\((Q, W)\)</span> the <a class="reference internal" href="../generated/neutronpy.instrument.PlotInstrument.plot_instrument.html#neutronpy.instrument.PlotInstrument.plot_instrument" title="neutronpy.instrument.PlotInstrument.plot_instrument"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_instrument</span></code></a> method can be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span><span class="o">.</span><span class="n">plot_instrument</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../reference/tutorials/instrument-6.py">Source code</a>, <a class="reference external" href="../../reference/tutorials/instrument-6.png">png</a>, <a class="reference external" href="../../reference/tutorials/instrument-6.hires.png">hires.png</a>, <a class="reference external" href="../../reference/tutorials/instrument-6.pdf">pdf</a>)</p>
<div class="figure">
<img alt="../../_images/instrument-6.png" src="../../_images/instrument-6.png" />
</div>
</div>
</div>
<div class="section" id="file-io">
<h3>File IO<a class="headerlink" href="#file-io" title="Permalink to this headline">¶</a></h3>
<div class="section" id="loading-an-instrument-and-sample-from-files">
<h4>Loading an Instrument and Sample from files<a class="headerlink" href="#loading-an-instrument-and-sample-from-files" title="Permalink to this headline">¶</a></h4>
<p>To load an instrument and sample respectively from cfg and par files <code class="xref py py-meth docutils literal notranslate"><span class="pre">load_instrument</span></code> can be used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy.io</span> <span class="k">import</span> <span class="n">load_instrument</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EXP</span> <span class="o">=</span> <span class="n">load_instrument</span><span class="p">(</span><span class="s1">&#39;path_to_cfg&#39;</span><span class="p">,</span> <span class="s1">&#39;path_to_par&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="time-of-flight-spectrometers">
<h2>Time of Flight spectrometers<a class="headerlink" href="#time-of-flight-spectrometers" title="Permalink to this headline">¶</a></h2>
<p>The follow sections of this tutorial cover the use of <a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html#neutronpy.instrument.Instrument" title="neutronpy.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a> with <code class="docutils literal notranslate"><span class="pre">instrument_type=&quot;tof&quot;</span></code>, which instances a <a class="reference internal" href="../generated/neutronpy.instrument.TimeOfFlightInstrument.html#neutronpy.instrument.TimeOfFlightInstrument" title="neutronpy.instrument.TimeOfFlightInstrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeOfFlightInstrument</span></code></a> object used to define a Time of Flight spectrometer configuration for resolution calculations.  The resolution calculation is performed using the “Violini method”, translated from “A method to compute the covariance matrix of wavevector-energy transfer for neutron time-of-flight spectrometers” by Violini et al., Nuclear Instruments and Methods in Physics Research A 736 (2014) 31-39. DOI: <a class="reference external" href="https://dx.doi.org/10.1016/j.nima.2013.10.042">10.1016/j.nima.2013.10.042</a>.</p>
<div class="section" id="id1">
<h3>Instrument Configuration<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Each TOF spectrometer object will include an incident <a class="reference internal" href="../generated/neutronpy.energy.Energy.html#neutronpy.energy.Energy" title="neutronpy.energy.Energy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Energy</span></code></a> object, two <a class="reference internal" href="../generated/neutronpy.instrument.Chopper.html#neutronpy.instrument.Chopper" title="neutronpy.instrument.Chopper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chopper</span></code></a> objects, two <a class="reference internal" href="../generated/neutronpy.instrument.Guide.html#neutronpy.instrument.Guide" title="neutronpy.instrument.Guide"><code class="xref py py-class docutils literal notranslate"><span class="pre">Guide</span></code></a> objects, a <a class="reference internal" href="../generated/neutronpy.instrument.Detector.html#neutronpy.instrument.Detector" title="neutronpy.instrument.Detector"><code class="xref py py-class docutils literal notranslate"><span class="pre">Detector</span></code></a> object, and a <a class="reference internal" href="../generated/neutronpy.crystal.Sample.html#neutronpy.crystal.Sample" title="neutronpy.crystal.Sample"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sample</span></code></a> object.</p>
<div class="section" id="building-a-sample">
<h4>Building a sample<a class="headerlink" href="#building-a-sample" title="Permalink to this headline">¶</a></h4>
<p>Samples use the same syntax as demonstrated above in the Triple Axis sections</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy</span> <span class="k">import</span> <span class="n">Sample</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">distance</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">distance</span></code> is also included, and is a mandatory kwarg for TOF instruments. Also note that a <code class="docutils literal notranslate"><span class="pre">mosaic</span></code> and <code class="docutils literal notranslate"><span class="pre">vmosaic</span></code> are used during the resolution calculation to estimate the resolution input parameters, and therefore if none is specified, 60 min is assumed for both.</p>
<p>The <a class="reference internal" href="../generated/neutronpy.crystal.Sample.html#neutronpy.crystal.Sample" title="neutronpy.crystal.Sample"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sample</span></code></a> object will allow calculation of <code class="docutils literal notranslate"><span class="pre">sigma_l_sd</span></code> (the path-length uncertainty between the sample and the detector), and <code class="docutils literal notranslate"><span class="pre">sigma_theta</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma_phi</span></code> (the uncertainties in the scattering angles).</p>
</div>
<div class="section" id="choppers">
<h4>Choppers<a class="headerlink" href="#choppers" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="../generated/neutronpy.instrument.Chopper.html#neutronpy.instrument.Chopper" title="neutronpy.instrument.Chopper"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chopper</span></code></a> objects are the first of the new components for Time of Flight instruments. Each chopper has a frequency at which it spins, a distance from the neutron source, and an opening of a particular size, which can be defined in several different ways. Note that the source position is not absolutely important, just the distances between the choppers, but you will typically get the information about the instrument in this format, thus this specification. A typical chopper with a set angular acceptance in degrees can be defined by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy.instrument</span> <span class="k">import</span> <span class="n">Chopper</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chopper1</span> <span class="o">=</span> <span class="n">Chopper</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;disk&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This first chopper is known as the “P chopper”, and is typically much more coarse than the second chopper, which is known as the “M chopper”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chopper2</span> <span class="o">=</span> <span class="n">Chopper</span><span class="p">(</span><span class="mi">1600</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s2">&quot;disk, 8)</span>
</pre></div>
</div>
<p>This defines both of our choppers, which will be passed in a list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">choppers</span> <span class="o">=</span> <span class="p">[</span><span class="n">chopper1</span><span class="p">,</span> <span class="n">chopper2</span><span class="p">]</span>
</pre></div>
</div>
<p>These objects will help <a class="reference internal" href="../generated/neutronpy.instrument.TimeOfFlightInstrument.html#neutronpy.instrument.TimeOfFlightInstrument" title="neutronpy.instrument.TimeOfFlightInstrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeOfFlightInstrument</span></code></a> calculate the values <code class="docutils literal notranslate"><span class="pre">tau_p</span></code> and <code class="docutils literal notranslate"><span class="pre">tau_m</span></code> (the time resolution of each of the choppers), <code class="docutils literal notranslate"><span class="pre">l_pm</span></code> and <code class="docutils literal notranslate"><span class="pre">l_ms</span></code> (the distance between the two choppers and between the M chopper and sample).</p>
</div>
<div class="section" id="guides">
<h4>Guides<a class="headerlink" href="#guides" title="Permalink to this headline">¶</a></h4>
<p>Next, the <a class="reference internal" href="../generated/neutronpy.instrument.Guide.html#neutronpy.instrument.Guide" title="neutronpy.instrument.Guide"><code class="xref py py-class docutils literal notranslate"><span class="pre">Guide</span></code></a> objects need to be defined by specifying the length, height, width, and m value.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy.instrument</span> <span class="k">import</span> <span class="n">Guide</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guide1</span> <span class="o">=</span> <span class="n">Guide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1600</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guide2</span> <span class="o">=</span> <span class="n">Guide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guides</span> <span class="o">=</span> <span class="p">[</span><span class="n">guide1</span><span class="p">,</span> <span class="n">guide2</span><span class="p">]</span>
</pre></div>
</div>
<p>These objects will help <a class="reference internal" href="../generated/neutronpy.instrument.TimeOfFlightInstrument.html#neutronpy.instrument.TimeOfFlightInstrument" title="neutronpy.instrument.TimeOfFlightInstrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeOfFlightInstrument</span></code></a> calculate <code class="docutils literal notranslate"><span class="pre">sigma_l_pm</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma_l_ms</span></code> (path-length uncertainties between the P and M choppers and the M chopper and the sample), and <code class="docutils literal notranslate"><span class="pre">sigma_theta_i</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma_phi_i</span></code> (the uncertainty in the in-plane and out-of-plane incident angles of the neutrons on the sample).</p>
</div>
<div class="section" id="detector">
<h4>Detector<a class="headerlink" href="#detector" title="Permalink to this headline">¶</a></h4>
<p>Finally, we must specify the :py:class`.Detector` object, specifying the shape (either spherical or cylindrical), width and height in degrees, radius in cm, horizontal pixels (given in angular acceptance of arc minutes), number of detector pixels in the vertical direction, and the time binning of the detector in microseconds. Detectors require by far the most information for the calculation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy.instrument</span> <span class="k">import</span> <span class="n">Detector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector</span> <span class="o">=</span> <span class="n">Detector</span><span class="p">(</span><span class="s2">&quot;cylindrical&quot;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>Initializing the instrument<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Now that we have defined all of our components we can initialize the instrument via <a class="reference internal" href="../generated/neutronpy.instrument.Instrument.html#neutronpy.instrument.Instrument" title="neutronpy.instrument.Instrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">Instrument</span></code></a>. Specifying <code class="docutils literal notranslate"><span class="pre">ei</span></code> can be done with either <a class="reference internal" href="../generated/neutronpy.energy.Energy.html#neutronpy.energy.Energy" title="neutronpy.energy.Energy"><code class="xref py py-class docutils literal notranslate"><span class="pre">Energy</span></code></a> or with a float.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">neutronpy</span> <span class="k">import</span> <span class="n">Instrument</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">(</span><span class="n">instrument_type</span><span class="o">=</span><span class="s2">&quot;tof&quot;</span><span class="p">,</span> <span class="n">ei</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">choppers</span><span class="o">=</span><span class="n">choppers</span><span class="p">,</span> <span class="n">guides</span><span class="o">=</span><span class="n">guides</span><span class="p">,</span> <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span> <span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively it is possible to build the default instrument and individually specify the necessary lengths and uncertainties. All of the following are the necessary values, but keep in mind to change the default sample as well.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span> <span class="o">=</span> <span class="n">Instrument</span><span class="p">(</span><span class="n">instrument_type</span><span class="o">=</span><span class="s2">&quot;tof&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">ei</span><span class="o">.</span><span class="n">energy</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="s2">&quot;cylindrical&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">tau_p</span> <span class="o">=</span> <span class="mf">80.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">tau_m</span> <span class="o">=</span> <span class="mf">20.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">tau_d</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">l_pm</span> <span class="o">=</span> <span class="mi">1600</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">l_ms</span> <span class="o">=</span> <span class="mi">200</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">l_sd</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">theta_i</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">phi_i</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_l_pm</span> <span class="o">=</span> <span class="mf">12.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_l_ms</span> <span class="o">=</span> <span class="mf">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_l_sd</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_theta_i</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_theta</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_phi_i</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">sigma_phi</span> <span class="o">=</span> <span class="mf">0.2</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="resolution-calculation">
<h3>Resolution calculation<a class="headerlink" href="#resolution-calculation" title="Permalink to this headline">¶</a></h3>
<p>Calculating the resolution at a particular position Q and energy transfer W works very similarly to that shown above for Triple Axis Spectrometers. In fact, the methods for calculating projections and ploting are completely shared between <a class="reference internal" href="../generated/neutronpy.instrument.TripleAxisInstrument.html#neutronpy.instrument.TripleAxisInstrument" title="neutronpy.instrument.TripleAxisInstrument"><code class="xref py py-class docutils literal notranslate"><span class="pre">TripleAxisInstrument</span></code></a> and :py:class`.TimeOfFlightInstrument`. To calculate resolution at [1, 1, 0, 0]</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">instr</span><span class="o">.</span><span class="n">calc_resolution</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>This will result in <code class="docutils literal notranslate"><span class="pre">R0</span></code>, <code class="docutils literal notranslate"><span class="pre">RM</span></code> and <code class="docutils literal notranslate"><span class="pre">RMS</span></code> attributes in <code class="docutils literal notranslate"><span class="pre">instr</span></code>, which hold the same meanings as for Triple Axis Spectrometer resolution calculations.</p>
<p>Projections can be generated and accessed in the same way as explained above for Triple Axis Spectrometers, as can plotting. Convolution methods are the only exceptions to this.</p>
</div>
<div class="section" id="id3">
<h3>File IO<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>File IO is not yet fully supported for Time of Flight spectrometers.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="material.html" class="btn btn-neutral float-right" title="Form Factor calculation with the Material Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gui.html" class="btn btn-neutral" title="Using the Resolution Calculation Graphical User Interface" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, David M Fobes.
      Last updated on Jun 25, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>
 
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7542685-4', 'auto');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');

</script>


</body>
</html>